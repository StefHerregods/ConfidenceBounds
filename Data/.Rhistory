rm(list = ls())
library(lme4)
library(dplyr)
library(ggplot2)
library(grid)
library(car)
library(effects)
library(optimx)
library(dfoptim)
library(ggResidpanel)
library(arm)
library(splines)
# https://stackoverflow.com/questions/26633483/collinearity-after-accounting-for-random-mixed-effects
vif.lme <- function (fit) {
# adapted from rms::vif
v <- vcov(fit)
nam <- names(fixef(fit))
# exclude intercepts
ns <- sum(1 * (nam == "Intercept" | nam == "(Intercept)"))
if (ns > 0) {
v <- v[-(1:ns), -(1:ns), drop = FALSE]
nam <- nam[-(1:ns)] }
d <- diag(v)^0.5
v <- diag(solve(v/(d %o% d)))
names(v) <- nam
v }
Sys.info()
Sys.info().user
Sys.info(user)
Sys.info("user")
Sys.info()['user']
Sys.info()['user']=="u01369378"
Sys.info()['user']['user']
Sys.info()['user']['user']=="u0136938"
Sys.info()['user']['user']=="u0136938"
Sys.info()['user']=="u0136938"
getwd()
## Setting working directory
if(Sys.info()['user']=="u0136938"){
setwd('C:/Users/u0136938/OneDrive - KU Leuven/Documents/Projecten/Stef - sato op confidence/ConfidenceBounds/Analyses/Exp1_analyse')
}else{
setwd('C:\\Users\\herre\\Desktop\\Internship\\Results\\Exp1_Results')
}
df <- read.csv(file = "Exp1_data_viable.csv")
## Setting working directory
if(Sys.info()['user']=="u0136938"){
setwd('C:/Users/u0136938/OneDrive - KU Leuven/Documents/Projecten/Stef - sato op confidence/ConfidenceBounds/Data')
}else{
setwd('C:\\Users\\herre\\Desktop\\Internship\\Results\\Exp1_Results')
}
df <- read.csv(file = "Exp1_data_viable.csv")
df <- df %>% mutate(rt_manipulation = as.factor(ifelse(df$manipulation %in% c("AccAcc", "AccFast"), 1, 0)),
rtconf_manipulation = as.factor(ifelse(df$manipulation %in% c("AccAcc", "FastAcc"), 1, 0)),
coherence = as.factor(coherence),
cor = as.factor(cor),
cj = as.factor(cj))
df_correct <- subset(df, cor == 1)
df_incorrect <- subset(df, cor == 0)
df_correct$rt_log <- log(df_correct$rt)
df_correct$rt_log <- scale(df_correct$rt_log, scale = FALSE)
cj_6 <- glmer(cj ~ 1 + rt_manipulation * rtconf_manipulation * coherence + (1 + coherence + rt_manipulation + rtconf_manipulation|sub),
data = df_correct, family = binomial, control = glmerControl(optimizer = "bobyqa"))
Anova(cj_6)
plot(effect('rt_manipulation:rtconf_manipulation', cj_6))
data.frame(effect('rt_manipulation:rtconf_manipulation', cj_6))
with(df_correct,aggraget(rt,by=list(rt_conf),mean))
with(df_correct,aggregate(rt,by=list(rt_conf),mean))
with(df_correct,aggregate(rt,by=list(rtconf_manipulation),mean))
with(df_correct,aggregate(rtconf,by=list(rtconf_manipulation),mean))
with(df_correct,aggregate(rtconf,by=list(rtconf_manipulation),mean))
with(df_correct,aggregate(rtconf,by=list(rtconf_manipulation),mean)) #
with(df_correct,aggregate(rt,by=list(rt_manipulation),mean))
data.frame(effect('rt_manipulation:rtconf_manipulation', cj_6))
plot(effect('rt_manipulation:coherence', cj_6))
data.frame(effect('rt_manipulation:coherence', cj_6))
temp <- data.frame(effect('rt_manipulation:coherence', cj_6))
temp
temp$fit[temp$rt_manipulation==0]
temp$fit[temp$rt_manipulation==0]-temp$fit[temp$rt_manipulation==1]
data.frame(effect('rt_manipulation:coherence', cj_6))
with(df_correct,aggregate(rt,by=list(rt_manipulation),mean))
RT_12 <- lmer(rt_log ~ 1 + rt_manipulation * rtconf_manipulation * coherence + (1 + rt_manipulation * rtconf_manipulation|sub),
data = df_correct, control = lmerControl(optimizer = "bobyqa"))
Anova(RT_12)  # For p-values
plot(effect('rt_manipulation:rtconf_manipulation', RT_12))
with(df_correct,aggregate(rt,by=list(rt_manipulation),mean))
plot(effect('rt_manipulation:coherence', RT_12))
data.frame(effect('rt_manipulation:coherence', RT_12))
temp <- data.frame(effect('rt_manipulation:coherence', RT_12))
temp
temp$fit[temp$rt_manipulation==1]
temp$fit[temp$rt_manipulation==1]-temp$fit[temp$rt_manipulation==0]
temp$fit[temp$rt_manipulation==1]
temp$fit[temp$rt_manipulation==0]
